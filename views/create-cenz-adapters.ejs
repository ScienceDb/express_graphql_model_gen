const axios_general = require('axios');
const globals = require('../config/globals');
const {
    handleError
} = require('../utils/errors');

let axios = axios_general.create();
axios.defaults.timeout = globals.MAX_TIME_OUT;

const remoteCenzontleURL = "<%- url -%>";
const iriRegex = "<%- regex -%>";

module.exports = class <%- adapterName -%>{


  static recognizeId(iri){
    return iriRegex.test(iri);
  }

  static readById(iri){
    let query = `query readOne<%- nameCp -%>{readOne<%- nameCp -%>(id: "${iri}"){ id <%for(var key in attributes){-%>
       <%=key %>
     <%}-%> }}  `;

     return axios.post(remoteCenzontleURL,{query: query}).then(res =>{
       let data = res.data.data.readOne<%- nameCp -%>;
       return data;
     }).catch(error =>{
       error['url'] = remoteCenzontleURL;
       handleError(error);
     });
  }

  static get name(){
    return "<%- adapterName -%>";
  }
}
