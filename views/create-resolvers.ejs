/*
    Resolvers for basic CRUD operations
*/

const <%-  nameLc  -%> = require('../models/index').<%- nameLc -%>;
const searchArg = require('../utils/search-argument');

module.exports = {
  <%- namePl -%>: function(_,context){
    return <%- nameLc -%>.findAll();
  },

  search<%- name -%>: function({input}){
    let arg = new searchArg(input);
    let arg_sequelize = arg.toSequelize();
    return <%- nameLc -%>.findAll({where: arg_sequelize});
  },

  readOne<%- name -%>: function({id}){
    return <%- nameLc -%>.findOne({where: {id: id}, include:[{all: true}]});
  },

  add<%- name -%>: function(input, context){
    return <%- nameLc -%>.create(input)
    .then( <%- nameLc -%> =>{
      return <%- nameLc -%>;
    });
  },

  delete<%- name -%>: function({id}, context){
    return <%- nameLc -%>
      .findById(id)
      .then( <%- nameLc -%> =>{
        return <%- nameLc -%>
          .destroy()
          .then(()=>{return 'Item succesfully deleted';});
        });
  },

  update<%- name -%>: function(input,context){
    return <%- nameLc -%>
      .findById(id)
      .then( <%- nameLc -%> => {
          return <%- nameLc -%>.update(input);
        });
  }
}
